<!DOCTYPE html>
<html lang="en">
<head>
    <title>Soundboard</title>
    <link rel="stylesheet" href="../../assets/main.css">
    <link rel="icon" type="image/x-icon" href="../../favicon.ico">
    <style>
    #soundboard {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
        gap: 5px 5px;
        font-size: 14px;
        font-family: var(--ff-ui);
    }
    .sb-btn {
        display: flex;
        aspect-ratio: 4/3;
        line-height: 1.5;
        justify-content: center;
        align-items: center;
        text-align: center;
        padding: 4px;
        border: 1px solid var(--grey-c);
    }
        .sb-btn:hover {
            background-color: var(--grey-e);
            border-color: var(--grey-8);
            cursor: pointer;
        }
        .sb-btn.pressed {
            background-color: var(--c-blue) !important;
            color: var(--grey-f);
        }
    .stick-below-nav {
        position: sticky;
        top: calc(var(--nav-height) + 5px);
    }
    .stop-btn {
        font-family: var(--ff-ui);
        cursor: pointer;
        border: 1px solid var(--grey-a);
        padding: 2px 8px;
        background-color: var(--c-pale-red);
        font-size: 14px;
    }
        .stop-btn:hover {
            background-color: var(--grey-e);
            border-color: var(--grey-8);
            cursor: pointer;
        }
    </style>
</head>
<body>

Soundboard

\<div class="flex-end stick-below-nav"><span class="stop-btn no-select" onclick="stopSounds()">‚ùå Stop all sounds (esc)</span>
</div>

\<div id="soundboard">
A few moments later (Narrator, SpongeBob SquarePants)
Curb your enthusiasm (outro music)
Grindr alert
Hah, gay! (Ben Chang, Community)
He can't keep getting away with it (Jesse Pinkman, Breaking Bad)
How the turn tables (Michael Scott, The Office)
I can't believe you've done this
Laugh track (stock)
Meta Gear Solid Alert (noise)
Oh, good for you (Christian Bale)
The Price Is Right (loss noise)
We don't say that word
What don't you fucking understand? (Christian Bale)
What the hell is even that?
What? Who? Who said that? (Mr. Plinkett)
What's wrong with your face? (Mr. Plinkett)
Wow (Stock anime noise)
You are such a simp (Martha, Who's Afraid of Virginia Woolf)
You guys I'm like really smart now you don't even know (Kelly Kapoor, The Office)
Discord - message alert
Discord - other user joins call
Discord - other user leaves call
Discord - stream ends
Discord - you deafen
Discord - you disconnect from call
Discord - you get moved
</div>

\<script src="../../assets/layout.js"></script>
<script>

const soundsPlaying = [];

function stopSounds() {
    while (soundsPlaying.length > 0) {
        soundsPlaying[0].pause();
        soundsPlaying[0].src = "";
        soundsPlaying.shift();
    }
    Array.from(document.getElementById("soundboard").children).forEach(k => k.classList.remove("pressed"));
}

function sbSetup() {
    let sb = document.getElementById("soundboard");
    let blocks = sb.innerHTML.split("\n").filter(l => l.trim().length > 1).map(l => `<div class="sb-btn no-select">${ l.trim() }</div>`).join("");
    sb.innerHTML = blocks;
    blocks = sb.children;
    
    for (let block of blocks) {
        let url = `media/${ block.innerHTML.replaceAll("?", "") }.mp3`;
        block.addEventListener("click", function() {
            let sound = new Audio(url);
            sound.play();
            soundsPlaying.push(sound);
            block.classList.add("pressed");
            sound.addEventListener("loadedmetadata", function() {
                setTimeout(function() {
                    let i1 = -1;
                    let i2 = -1;
                    for (let j = 0; j < soundsPlaying.length; j += 1) {
                        if (i1 == -1 && soundsPlaying[j].src == sound.src) {
                            i1 = j;
                        } else if (i2 == -1 && soundsPlaying[j].src == sound.src) {
                            i2 = j;
                            break;
                        }
                    }
                    if (i1 > -1) {
                        soundsPlaying.splice(i1, 1);
                        if (i2 == -1) {
                            block.classList.remove("pressed");
                        }
                    }
                }, sound.duration * 1000);
            })
        })
    }
    window.addEventListener("keydown", k => {
        if (k.keyCode==27) {
            stopSounds();
        }
    })
}

window.addEventListener("load", sbSetup);


</script>
</body></html>



